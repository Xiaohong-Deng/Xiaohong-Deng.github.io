<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Shawn's Den</title><link href="https://shawnsden.ga/" rel="alternate"></link><link href="https://shawnsden.ga/feeds/all.atom.xml" rel="self"></link><id>https://shawnsden.ga/</id><updated>2018-12-15T13:12:00+08:00</updated><subtitle>Curiosity and Audacity</subtitle><entry><title>Github: Add a Project Page to Your Personal Page</title><link href="https://shawnsden.ga/articles/add-a-project-page-to-your-personal-page.html" rel="alternate"></link><published>2018-12-15T13:12:00+08:00</published><updated>2018-12-15T13:12:00+08:00</updated><author><name>Xiaohong Deng</name></author><id>tag:shawnsden.ga,2018-12-15:/articles/add-a-project-page-to-your-personal-page.html</id><summary type="html">&lt;p&gt;Say you have a blog backed by Github personal or organization page which is one per account only. You have a custom domain name for it served by some DNS service. Now you want to use the same custom domain name to serve a project page to showcase your projects …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Say you have a blog backed by Github personal or organization page which is one per account only. You have a custom domain name for it served by some DNS service. Now you want to use the same custom domain name to serve a project page to showcase your projects, say &lt;code&gt;portfolio.your_custom_domain.ga&lt;/code&gt;. How do you do that?&lt;/p&gt;
&lt;h3&gt;Getting Started&lt;/h3&gt;
&lt;p&gt;Github allows you to have unlimited number of Project pages. Create a new one called &lt;code&gt;portfolio&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;In &lt;strong&gt;Setting&lt;/strong&gt;, Under &lt;strong&gt;Github Pages&lt;/strong&gt;, &lt;strong&gt;Choose a theme&lt;/strong&gt;. Once settled, your portfolio page can be accessed at &lt;code&gt;https://your_github_username.github.io/portfolio&lt;/code&gt;&lt;/p&gt;
&lt;h3&gt;Custom Domain Name&lt;/h3&gt;
&lt;p&gt;Under &lt;strong&gt;Github Pages&lt;/strong&gt;, &lt;strong&gt;Custom domain&lt;/strong&gt;. Fill in &lt;code&gt;portfolio.your_custom_domain.com&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Go to your DNS service website, you should have a panel for managing your DNS somewhere. Add a record of type CNAME with NAME &lt;strong&gt;PORTFOLIO&lt;/strong&gt;. Point it to your Personal page &lt;code&gt;your_github_username.github.io&lt;/code&gt;. That should be all.&lt;/p&gt;
&lt;h3&gt;Custom Theme&lt;/h3&gt;
&lt;p&gt;By choosing a theme, you implicitly added &lt;code&gt;theme: theme_name&lt;/code&gt; to &lt;code&gt;_config.yml&lt;/code&gt;. It's hard to customize your page layout and style using theme this way. Instead, you should remove that line and copy everything in the theme repository to your project directory. In my case, &lt;code&gt;jekyll-theme-minimal&lt;/code&gt; and &lt;code&gt;portfolio&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Then you can modify the &lt;code&gt;.css&lt;/code&gt;, &lt;code&gt;.js&lt;/code&gt; and &lt;code&gt;.html&lt;/code&gt; files to get the visual effect you want. For example, if you want to add Github or Facebook icons to your project page, you may add &lt;code&gt;font-awesome.min.css&lt;/code&gt; hosted at CloudFare to your layout file. Now you can create icons using &lt;code&gt;fa-github&lt;/code&gt; or &lt;code&gt;fa-facebook&lt;/code&gt; where you want.&lt;/p&gt;</content><category term="pelican"></category></entry><entry><title>Pelican: Python 3 or Upgrading to Python 3</title><link href="https://shawnsden.ga/articles/pelican--python-3-or-upgrading-to-python-3.html" rel="alternate"></link><published>2018-12-14T15:44:00+08:00</published><updated>2018-12-14T15:44:00+08:00</updated><author><name>Xiaohong Deng</name></author><id>tag:shawnsden.ga,2018-12-14:/articles/pelican--python-3-or-upgrading-to-python-3.html</id><summary type="html">&lt;p&gt;&lt;a href="http://nafiulis.me/making-a-static-blog-with-pelican.html#getting-started"&gt;Making a Static Blog with Pelican&lt;/a&gt; is a great tutorial for beginners to start with Pelican. It was in Python 2 because back then &lt;code&gt;fabric&lt;/code&gt; is incompatible with Python 3. Now Pelican has moved to &lt;code&gt;invoke&lt;/code&gt; by default which is very similar to &lt;code&gt;fabric&lt;/code&gt; which supports Python 3 now. Both …&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;a href="http://nafiulis.me/making-a-static-blog-with-pelican.html#getting-started"&gt;Making a Static Blog with Pelican&lt;/a&gt; is a great tutorial for beginners to start with Pelican. It was in Python 2 because back then &lt;code&gt;fabric&lt;/code&gt; is incompatible with Python 3. Now Pelican has moved to &lt;code&gt;invoke&lt;/code&gt; by default which is very similar to &lt;code&gt;fabric&lt;/code&gt; which supports Python 3 now. Both &lt;code&gt;invoke&lt;/code&gt; and &lt;code&gt;fabric&lt;/code&gt; are authored by the same person. It's time to use Pelican with Python 3 and enjoy the automation from &lt;code&gt;invoke&lt;/code&gt;.&lt;/p&gt;
&lt;h3&gt;Getting Started&lt;/h3&gt;
&lt;p&gt;You can either install all the dependencies in a virtual environment or not. For me, I chose to install Pelican in a conda env.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;conda create -n pelican &lt;span class="nv"&gt;python&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;.6
&lt;span class="nb"&gt;source&lt;/span&gt; activate pelican
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Automation&lt;/h3&gt;
&lt;p&gt;After installing Pelican, you should run &lt;code&gt;pelican-quickstart&lt;/code&gt; to get a updated &lt;code&gt;Makefile&lt;/code&gt; and &lt;code&gt;tasks.py&lt;/code&gt;. The latter should be used to replace &lt;code&gt;fabfile.py&lt;/code&gt; if you have a Pelican working directory created with Python 2.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;fabric&lt;/code&gt; API was reorganized since v2.0. &lt;code&gt;invoke&lt;/code&gt; is more like Fabric2. So command line automation works differently now. To call functions defined in &lt;code&gt;tasks.py&lt;/code&gt; you have to prepend &lt;code&gt;@task&lt;/code&gt; to each function meant to be called in command line and add a parameter which will be set to a &lt;code&gt;Context&lt;/code&gt; by the decorator. Check out the following code snippet to get a hang of it.&lt;/p&gt;
&lt;p&gt;Note: When calling a function in command line you must replace underscores with hyphens.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# in command line use `invoke make-entry -p port_string` or `invoke make-entry` to go with default value&lt;/span&gt;
&lt;span class="nd"&gt;@task&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;livebuild&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;port&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;8080&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;make clean&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# 1&lt;/span&gt;
    &lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;make html&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# 2&lt;/span&gt;
    &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;chdir&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;output&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# 3&lt;/span&gt;
    &lt;span class="n"&gt;server&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;livereload&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Server&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;  &lt;span class="c1"&gt;# 4&lt;/span&gt;
    &lt;span class="n"&gt;server&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;watch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;../content/articles/*.md&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="c1"&gt;# 5&lt;/span&gt;
        &lt;span class="n"&gt;livereload&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shell&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;pelican -s ../pelicanconf.py -o ../output&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;  &lt;span class="c1"&gt;# 6&lt;/span&gt;
    &lt;span class="n"&gt;server&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;watch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;../content/pages/*.md&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="n"&gt;livereload&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shell&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;pelican -s ../pelicanconf.py -o ../output&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="n"&gt;server&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;watch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;../pure/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="c1"&gt;# 7&lt;/span&gt;
        &lt;span class="n"&gt;livereload&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shell&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;pelican -s ../pelicanconf.py -o ../output&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;  &lt;span class="c1"&gt;# 8&lt;/span&gt;
    &lt;span class="n"&gt;server&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;watch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;../pelicanconf.py&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="n"&gt;livereload&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shell&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;pelican -s ../pelicanconf.py -o ../output&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="n"&gt;server&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;watch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;*.html&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# 9&lt;/span&gt;
    &lt;span class="n"&gt;server&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;watch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;*.css&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# 10&lt;/span&gt;
    &lt;span class="n"&gt;server&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;serve&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;liveport&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;35729&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;port&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;port&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# 11&lt;/span&gt;


&lt;span class="nd"&gt;@task&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;enter_dns_file&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;  &lt;span class="c1"&gt;# 1&lt;/span&gt;
    &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;output/CNAME&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;w&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;some_custom_domain&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


&lt;span class="c1"&gt;# in command line use `invoke make-entry -p` to go with True or `invoke make-entry` to go with default value False&lt;/span&gt;
&lt;span class="nd"&gt;@task&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;github&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;publish_drafts&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;False&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;  &lt;span class="c1"&gt;# 2&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;publish_drafts&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;  &lt;span class="c1"&gt;# 3&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exists&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;output/drafts&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;publish_drafts&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;rm -rf output/drafts&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="ne"&gt;Exception&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;pass&lt;/span&gt;

    &lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ghp-import output&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# 4&lt;/span&gt;
    &lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;git push&amp;#39;&lt;/span&gt;
          &lt;span class="s1"&gt;&amp;#39; your_github_personal_project_domain&amp;#39;&lt;/span&gt;
          &lt;span class="s1"&gt;&amp;#39; gh-pages:master&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# 5&lt;/span&gt;
    &lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;rm -rf output&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# 6&lt;/span&gt;


&lt;span class="nd"&gt;@task&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;one_click&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;preview&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;enter_dns_file&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;github&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;If you want to call any function in command line as tasks, you must set the first
parameter, this will be initialized to a &lt;code&gt;Context&lt;/code&gt; by &lt;code&gt;task()&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;For functions like &lt;code&gt;github()&lt;/code&gt; which has a default boolean valued parameter, if you want to call
it in command line you can explicitly specify a flag &lt;code&gt;-p&lt;/code&gt; to set it to true, or omit it
to set it to the default value which is false&lt;/p&gt;
&lt;p&gt;if you don't need any parameters you still must set a parameter which is set to a Context by task
by default, then you can call them in command line. Otherwise you get an error
As you can see if you want to call them in other functions you must explicitly pass a Context to them&lt;/p&gt;
&lt;p&gt;If you remove c for &lt;code&gt;github()&lt;/code&gt; it will still work but &lt;code&gt;publish_drafts&lt;/code&gt; will be set to a &lt;code&gt;Context&lt;/code&gt;, being called
as a command line task or within another function&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Context&lt;/code&gt; can serve as a &lt;code&gt;connection&lt;/code&gt; such that you can call shell commands on it. Or directly call shell commands
using invoke.run. Either way you must define a &lt;code&gt;Context&lt;/code&gt; parameter for most functions, which is annoying.&lt;/p&gt;
&lt;h3&gt;Wrap Up&lt;/h3&gt;
&lt;p&gt;That's pretty much all you need to know about Pelican in Python 3. Enjoy the ride with Pelican.&lt;/p&gt;
&lt;hr&gt;</content><category term="pelican"></category></entry><entry><title>Jasmine Setup in UCB CS169x and SaaS Book</title><link href="https://shawnsden.ga/articles/jasmine-setup-in-ucb-cs169x-and-saas-book.html" rel="alternate"></link><published>2017-08-16T05:51:00+08:00</published><updated>2017-08-16T05:51:00+08:00</updated><author><name>Xiaohong Deng</name></author><id>tag:shawnsden.ga,2017-08-16:/articles/jasmine-setup-in-ucb-cs169x-and-saas-book.html</id><summary type="html">&lt;p&gt;You can use either &lt;code&gt;gem jasmine&lt;/code&gt; or &lt;code&gt;gem jasmine-rails&lt;/code&gt; to set up Jasmine framework in your rails apps. In the SaaS book, it uses the latter. &lt;code&gt;gem jasmine-jquery-rails&lt;/code&gt; is one way to exploit the extra matchers and fixtures loading feature from &lt;code&gt;jasmine-jquery&lt;/code&gt;. It needs jquery as a prerequisite.&lt;/p&gt;
&lt;p&gt;You won't …&lt;/p&gt;</summary><content type="html">&lt;p&gt;You can use either &lt;code&gt;gem jasmine&lt;/code&gt; or &lt;code&gt;gem jasmine-rails&lt;/code&gt; to set up Jasmine framework in your rails apps. In the SaaS book, it uses the latter. &lt;code&gt;gem jasmine-jquery-rails&lt;/code&gt; is one way to exploit the extra matchers and fixtures loading feature from &lt;code&gt;jasmine-jquery&lt;/code&gt;. It needs jquery as a prerequisite.&lt;/p&gt;
&lt;p&gt;You won't be able to run jasmine tests in the browser smoothly by just following the SaaS book $6.7. At least not by Aug. 2017.&lt;/p&gt;
&lt;p&gt;First make sure you installed &lt;code&gt;gem jasmine-rails&lt;/code&gt; and &lt;code&gt;gem jasmine-jquery-rails&lt;/code&gt;. After &lt;code&gt;rails g jasmine_rails:install&lt;/code&gt;, add &lt;code&gt;//= require jasmine-jquery&lt;/code&gt; to &lt;code&gt;application.js&lt;/code&gt;. Alternatively, &lt;code&gt;jasmine-jquery-rails&lt;/code&gt; can be included by adding &lt;code&gt;src_file: - assets/jasmine-jquery.js&lt;/code&gt; to &lt;code&gt;jasmine.yml&lt;/code&gt;. This would load matchers from &lt;code&gt;jasmine-jquery&lt;/code&gt;. Both &lt;code&gt;gem jasmine-rails&lt;/code&gt; and &lt;code&gt;gem jasmine&lt;/code&gt; depend on it. The default fixtures loading path is &lt;code&gt;spec/javascripts/fixtures&lt;/code&gt; but testing in the browser is not able to load fixtures. The workaround can be found at &lt;a href="https://github.com/travisjeffery/jasmine-jquery-rails/issues/4"&gt;this jasmine-jquery-rails issue&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;You need to create a &lt;code&gt;config/initializers/jasmine_fixtures.rb&lt;/code&gt; and fill it with&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# Map fixtures directory for Jasmine suite&lt;/span&gt;
&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;defined?&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="no"&gt;Jasmine&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="no"&gt;Jquery&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="no"&gt;Rails&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="no"&gt;Engine&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="no"&gt;JasmineFixtureServer&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="no"&gt;Proc&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;new&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;env&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
    &lt;span class="no"&gt;Rack&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="no"&gt;Directory&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;new&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;spec/javascripts/fixtures&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;call&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;env&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Then open &lt;code&gt;routes.rb&lt;/code&gt; and add&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;  &lt;span class="c1"&gt;# mount spec/javascripts/fixtures directory&lt;/span&gt;
  &lt;span class="n"&gt;mount&lt;/span&gt; &lt;span class="no"&gt;JasmineFixtureServer&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;/spec/javascripts/fixtures&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;defined?&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="no"&gt;Jasmine&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="no"&gt;Jquery&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="no"&gt;Rails&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="no"&gt;Engine&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;On &lt;a href="https://github.com/travisjeffery/jasmine-jquery-rails"&gt;jasmine-jquery-rails github page&lt;/a&gt; it implies that it takes effect through asset pipeline. That explains why the above settings are effective in browser but when you run &lt;code&gt;rake spec:javascript&lt;/code&gt; in CLI it fails.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;jasmine-rails&lt;/code&gt; doesn't support fixtures. It recommend &lt;a href="https://github.com/searls/jasmine-fixture"&gt;jasmine-fixture&lt;/a&gt;. It provides syntax for loading fixtures that is different from &lt;code&gt;jasmine-jquery&lt;/code&gt;. So in order to use it you need to rewrite part of your tests first. So much for loading fixtures while testing in CLI using &lt;code&gt;jasmine-rails&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;After you did all the settings for &lt;code&gt;jasmine-rails&lt;/code&gt; and &lt;code&gt;jasmine-jquery-rails&lt;/code&gt;, without removing the two gems, you can add &lt;code&gt;gem jasmine&lt;/code&gt; and run &lt;code&gt;rake jasmine:install&lt;/code&gt;. Then either you run &lt;code&gt;rake jasmine&lt;/code&gt; and visit &lt;code&gt;localhost:8888&lt;/code&gt; or run &lt;code&gt;rake jasmine:ci&lt;/code&gt; to run the tests in the CLI, the tests will be run smoothly, regarding all the matchers from &lt;code&gt;jasmine-jquery&lt;/code&gt; and fixtures.&lt;/p&gt;
&lt;p&gt;After poking around in the relavent files, I found that &lt;code&gt;gem jasmine&lt;/code&gt; load fixtures perfectly fine without the route hacking, no matter from a browser or CLI. But even in CLI from the message shown I think it relies on &lt;code&gt;jasmine-jquery-rails&lt;/code&gt; through asset pipeline by firing up a server.&lt;/p&gt;</content><category term="rails"></category></entry><entry><title>Set Up Disqus With Pelican</title><link href="https://shawnsden.ga/articles/set-up-disqus-with-pelican.html" rel="alternate"></link><published>2017-07-04T20:57:00+08:00</published><updated>2017-07-04T20:57:00+08:00</updated><author><name>Xiaohong Deng</name></author><id>tag:shawnsden.ga,2017-07-04:/articles/set-up-disqus-with-pelican.html</id><summary type="html">&lt;p&gt;There are a few variables in &lt;code&gt;pelicanconf.py&lt;/code&gt; involved in this problem, there are a few that break your app in other ways. I'm gonna concentrate on those directly involved and traps you might get caught up with.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;This Disqus comment feature can not be previewed locally&lt;/strong&gt;, I will explain …&lt;/li&gt;&lt;/ul&gt;</summary><content type="html">&lt;p&gt;There are a few variables in &lt;code&gt;pelicanconf.py&lt;/code&gt; involved in this problem, there are a few that break your app in other ways. I'm gonna concentrate on those directly involved and traps you might get caught up with.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;This Disqus comment feature can not be previewed locally&lt;/strong&gt;, I will explain it later.&lt;/li&gt;
&lt;li&gt;Just in case, set &lt;code&gt;RELATIVE_URLS&lt;/code&gt; to &lt;code&gt;True&lt;/code&gt; in &lt;code&gt;pelicanconf.py&lt;/code&gt; and to &lt;code&gt;False&lt;/code&gt; in &lt;code&gt;publishconf.py&lt;/code&gt;. Set &lt;code&gt;SITEURL&lt;/code&gt; to your domain name in the form of &lt;code&gt;http://domainame.me&lt;/code&gt; in &lt;code&gt;publishconf.py&lt;/code&gt;. Generate your site using &lt;code&gt;publishconf.py&lt;/code&gt; if you want to view it remotely.&lt;/li&gt;
&lt;li&gt;Set &lt;code&gt;DISQUS_SITENAME&lt;/code&gt; = &amp;lt;YOUR_DOMAIN&gt;. It can be any string you like.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Registration at Disqus&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Follow &lt;a href="https://github.com/getpelican/pelican-plugins/tree/master/disqus_static"&gt;disqus_static plugin installation&lt;/a&gt;, the html text under &lt;strong&gt;usage&lt;/strong&gt; is not relevant in most of the themes. Of course I can't test them all. When register the application at Disqus, there are many blanks you need to fill in. Fill in &amp;lt;YOUR_DOMAIN&gt; when possible, in case some blank is used to match DISQUS_SITENAME.&lt;/li&gt;
&lt;li&gt;Do not move &lt;code&gt;disqus_static.py&lt;/code&gt; to &lt;code&gt;plugin&lt;/code&gt; folder in &lt;code&gt;pelican&lt;/code&gt; installation directory. Instead, specify the &lt;code&gt;PLUGIN_PATHS&lt;/code&gt; as &lt;a href="http://docs.getpelican.com/en/stable/plugins.html"&gt;pelican docs&lt;/a&gt; suggests.&lt;/li&gt;
&lt;li&gt;There is another registration process you need to go through. I don't remember where is the entrance, but the first step is for you to choose whether you want to comment as a user or install Disqus comment feature to your site. After the registration &lt;code&gt;&amp;lt;YOUR_DOMAIN&amp;gt;.disqus.com/admin/settings&lt;/code&gt; should be accessible. Click &lt;code&gt;site -&amp;gt; advanced&lt;/code&gt; on the left. Add &lt;code&gt;SITEURL&lt;/code&gt; to &lt;strong&gt;Trusted Domains&lt;/strong&gt;. &lt;code&gt;localhost&lt;/code&gt; or &lt;code&gt;127.0.0.1&lt;/code&gt; can't be added. That's why this feature can't be previewed locally.&lt;/li&gt;
&lt;li&gt;At some step of the above registration process, you will be asked for the blogging system you tend to apply Disqus to. Pelican is not on the list and you will be directed to some universal embedded code. Pelican doesn't need those code to work with Disqus. You can safely ignore it.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;If Things Mesh&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;If you set &lt;code&gt;DISQUS_SITENAME&lt;/code&gt; and it matches the corresponding setting on Disqus.com, for some themes like &lt;code&gt;pelican-clean-blog&lt;/code&gt; &lt;code&gt;comment&lt;/code&gt; hyperlinks should be visible under each article on the index page. This part is independent of the next part.&lt;/li&gt;
&lt;li&gt;When the comment section is not loaded on an article page, for some themes it's hard to tell if your plugin is not loaded correctly or it's communication failure between your site and Disqus. Those themes fail silently. Some other themes will show error message "We were unable to load Disqus" and give a &lt;a href="https://help.disqus.com/customer/portal/articles/472007-i-m-receiving-the-message-%22we-were-unable-to-load-disqus-%22"&gt;trouble shooting link&lt;/a&gt;. That means the plugin is loaded correctly. For themes that fail silently you can comment out &lt;code&gt;PLUGIN_PATHS&lt;/code&gt; and &lt;code&gt;PLUGINS&lt;/code&gt; to see if things are different in any ways. Themes like &lt;strong&gt;Flex&lt;/strong&gt; are integrated with Disqus plugin so that's trouble saving.&lt;/li&gt;
&lt;/ul&gt;</content><category term="pelican"></category></entry><entry><title>Rails ActionMailer: Explain Why Calling Class Methods That Do Not Exist on Mailers Works</title><link href="https://shawnsden.ga/articles/rails-actionmailer-explain-why-calling-class-methods-that-do-not-exist-on-mailers-works.html" rel="alternate"></link><published>2017-07-01T10:36:00+08:00</published><updated>2017-07-01T10:36:00+08:00</updated><author><name>Xiaohong Deng</name></author><id>tag:shawnsden.ga,2017-07-01:/articles/rails-actionmailer-explain-why-calling-class-methods-that-do-not-exist-on-mailers-works.html</id><summary type="html">&lt;!-- Summary: --&gt;

&lt;p&gt;Here is &lt;a href="http://karolgalanciak.com/blog/2016/07/31/decoding-rails-magic-how-does-calling-class-methods-on-mailers-work"&gt;an article&lt;/a&gt; from Karol Galanciak you can refer to as a start. I'm gonna rewrite his article in a way that conveys pretty much the same information with addditional detail generated by me reading the Rails source code. Hopefully it would crystalize your understanding on the subject further …&lt;/p&gt;</summary><content type="html">&lt;!-- Summary: --&gt;

&lt;p&gt;Here is &lt;a href="http://karolgalanciak.com/blog/2016/07/31/decoding-rails-magic-how-does-calling-class-methods-on-mailers-work"&gt;an article&lt;/a&gt; from Karol Galanciak you can refer to as a start. I'm gonna rewrite his article in a way that conveys pretty much the same information with addditional detail generated by me reading the Rails source code. Hopefully it would crystalize your understanding on the subject further. Most of the code snippets are snatched from Michael Hartl's Rails Tutorial&lt;/p&gt;
&lt;p&gt;In a Rails app, you generate a Mailer by typing the following in the terminal&lt;/p&gt;
&lt;p&gt;&lt;code&gt;rails g mailer UserMailer account_activation&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Inside &lt;code&gt;user_mailer.rb&lt;/code&gt; you have&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;UserMailer&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="no"&gt;ApplicationMailer&lt;/span&gt;
  &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;account_activation&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="vi"&gt;@user&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;user&lt;/span&gt;
    &lt;span class="n"&gt;mail&lt;/span&gt; &lt;span class="ss"&gt;to&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;email&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;subject&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Account activation&amp;quot;&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;After that you can send email to &lt;code&gt;user&lt;/code&gt; by&lt;/p&gt;
&lt;p&gt;&lt;code&gt;UserMailer.account_activation(user).deliver_now&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;You can preview the mail in &lt;code&gt;user_mailer_preview&lt;/code&gt; by the following&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;UserMailerPreview&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="no"&gt;ActionMailer&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="no"&gt;Preview&lt;/span&gt;

  &lt;span class="c1"&gt;# Preview this email at http://localhost:3000/rails/mailers/user_mailer/account_activation&lt;/span&gt;
  &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;account_activation&lt;/span&gt;
    &lt;span class="n"&gt;user&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="no"&gt;User&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;first&lt;/span&gt;
    &lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;activation_token&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="no"&gt;User&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;new_token&lt;/span&gt;
    &lt;span class="c1"&gt;# account_activation is an instance method&lt;/span&gt;
    &lt;span class="c1"&gt;# of UserMailer. What&amp;#39;s going on?&lt;/span&gt;
    &lt;span class="no"&gt;UserMailer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;account_activation&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;You can create a &lt;code&gt;user_mailer_test.rb&lt;/code&gt; and do the following&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nb"&gt;require&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;test_helper&amp;#39;&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;UserMailerTest&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="no"&gt;ActionMailer&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="no"&gt;TestCase&lt;/span&gt;

  &lt;span class="nb"&gt;test&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;account_activation&amp;quot;&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
    &lt;span class="n"&gt;mail&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="no"&gt;UserMailer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;account_activation&lt;/span&gt;
    &lt;span class="n"&gt;assert_equal&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Account activation&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mail&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subject&lt;/span&gt;
    &lt;span class="n"&gt;assert_equal&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;to@example.org&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mail&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;to&lt;/span&gt;
    &lt;span class="n"&gt;assert_equal&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;from@example.com&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mail&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;from&lt;/span&gt;
    &lt;span class="n"&gt;assert_match&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Hi&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mail&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;body&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;encoded&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Why &lt;code&gt;account_activation&lt;/code&gt; Is Defined as An Instance Method But Called as A Class Method?&lt;/h2&gt;
&lt;p&gt;You'd probably have guessed &lt;code&gt;method_missing&lt;/code&gt; is behind the curtain. That's correct. &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Base&lt;/span&gt;
  &lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="nb"&gt;self&lt;/span&gt;
  &lt;span class="o"&gt;...&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;method_missing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;method_name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
      &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;action_methods&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;include?&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;method_name&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;to_s&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="no"&gt;MessageDelivery&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;new&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;method_name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
      &lt;span class="k"&gt;else&lt;/span&gt;
        &lt;span class="k"&gt;super&lt;/span&gt;
      &lt;span class="k"&gt;end&lt;/span&gt;
    &lt;span class="k"&gt;end&lt;/span&gt;
  &lt;span class="o"&gt;...&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Calling the instance method as a class method results in a &lt;code&gt;MessageDelivery&lt;/code&gt; object. &lt;code&gt;MessageDelivery&lt;/code&gt; is a subclass of &lt;code&gt;Delegator&lt;/code&gt;. It's a wrapper of the related object. In this case Mail::Message. You can retrieve the wrapped object by &lt;code&gt;md.message&lt;/code&gt; given &lt;code&gt;md&lt;/code&gt; is a &lt;code&gt;MessageDelivery&lt;/code&gt; object. The Mailer class, in this case &lt;code&gt;UserMailer&lt;/code&gt;, instance method &lt;code&gt;account_activation&lt;/code&gt; and arg &lt;code&gt;user&lt;/code&gt; are passed to the &lt;code&gt;MessageDelivery&lt;/code&gt; object.&lt;/p&gt;
&lt;p&gt;Note that &lt;code&gt;action_methods&lt;/code&gt; is inherited from &lt;code&gt;AbstractController::Base&lt;/code&gt;. &lt;code&gt;method_missing&lt;/code&gt; here is defined in singleton class. The scope in singleton class is the class itself. So &lt;code&gt;method_missing&lt;/code&gt; handles class methods.&lt;/p&gt;
&lt;p&gt;Returning a &lt;code&gt;MessageDelivery&lt;/code&gt; object doesn't quite answer the question, does it? What about instance method &lt;code&gt;account_activation&lt;/code&gt;? Does it get called somewhere?&lt;/p&gt;
&lt;h2&gt;What Does &lt;code&gt;MessageDelivery#deliver_now&lt;/code&gt; Do&lt;/h2&gt;
&lt;p&gt;First, we have&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;deliver_now&lt;/span&gt;
  &lt;span class="n"&gt;processed_mailer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;handle_exceptions&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
    &lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;deliver&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Note &lt;code&gt;message&lt;/code&gt; in the code is called on an instance of &lt;code&gt;MessageDelivery&lt;/code&gt;. Though internally it is a delegator of &lt;code&gt;processed_mailer&lt;/code&gt;. That is, &lt;code&gt;deliver&lt;/code&gt; is actually called on &lt;code&gt;processed_mailer.message&lt;/code&gt;. &lt;code&gt;message&lt;/code&gt; is an &lt;code&gt;attr_internal&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Let's look into &lt;code&gt;processed_mailer&lt;/code&gt; method&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;processed_mailer&lt;/span&gt;
  &lt;span class="vi"&gt;@processed_mailer&lt;/span&gt; &lt;span class="o"&gt;||=&lt;/span&gt; &lt;span class="vi"&gt;@mailer_class&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;new&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tap&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;mailer&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
    &lt;span class="n"&gt;mailer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;process&lt;/span&gt; &lt;span class="vi"&gt;@action&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="vi"&gt;@args&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Here &lt;code&gt;@mailer_class&lt;/code&gt; is &lt;code&gt;UserMailer&lt;/code&gt; in our case. &lt;code&gt;tap&lt;/code&gt; is defiend in &lt;code&gt;Object&lt;/code&gt; as follows&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Object&lt;/span&gt;
  &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;tap&lt;/span&gt;
    &lt;span class="k"&gt;yield&lt;/span&gt; &lt;span class="nb"&gt;self&lt;/span&gt;
    &lt;span class="nb"&gt;self&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;So &lt;code&gt;processed_mailer&lt;/code&gt; is equivalent to&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;mailer&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="vi"&gt;@mailer_class&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;new&lt;/span&gt;
&lt;span class="n"&gt;mailer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;process&lt;/span&gt; &lt;span class="vi"&gt;@action&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;
&lt;span class="vi"&gt;@processed_mailer&lt;/span&gt; &lt;span class="o"&gt;||=&lt;/span&gt; &lt;span class="n"&gt;mailer&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;I won't dig into &lt;code&gt;process&lt;/code&gt; deeper because it is quite involved. I assume process executes the instance method on the &lt;code&gt;UserMailer&lt;/code&gt; object. Almost all instance methods of &lt;code&gt;MessageDelivery&lt;/code&gt; call &lt;code&gt;processed_mailer&lt;/code&gt; internally. That more or less answers the question that if &lt;code&gt;account_activation&lt;/code&gt; gets called somewhere?&lt;/p&gt;
&lt;h2&gt;Why Preview Can Show Mail Content by Returning a &lt;code&gt;MessageDelivery&lt;/code&gt; Object&lt;/h2&gt;
&lt;p&gt;I can only guess that by visiting the URL specified above the method, some instance methods get triggered on the returned &lt;code&gt;MessageDelivery&lt;/code&gt; object.&lt;/p&gt;
&lt;h2&gt;Why Methods &lt;code&gt;to&lt;/code&gt;, &lt;code&gt;from&lt;/code&gt; and &lt;code&gt;subject&lt;/code&gt; Can Be Called on &lt;code&gt;MessageDelivery&lt;/code&gt; Object&lt;/h2&gt;
&lt;p&gt;You guessed it again, &lt;code&gt;method_missing&lt;/code&gt;! This time it's the &lt;code&gt;method_missing&lt;/code&gt; inherited from &lt;code&gt;Delegator&lt;/code&gt;. It calls &lt;code&gt;__getobj__&lt;/code&gt; which calls &lt;code&gt;message&lt;/code&gt; on &lt;code&gt;MessageDelivery&lt;/code&gt; object and returns the wrapped object, &lt;code&gt;Mail::Message&lt;/code&gt;. It has methods &lt;code&gt;to&lt;/code&gt;, &lt;code&gt;from&lt;/code&gt; and &lt;code&gt;subject&lt;/code&gt;.&lt;/p&gt;
&lt;h2&gt;Wrap Up&lt;/h2&gt;
&lt;p&gt;That's it. That is our little tour of visiting some Mailer related Rails source code. Hope that resolves your confusion to some extent.&lt;/p&gt;</content><category term="rails"></category></entry></feed>